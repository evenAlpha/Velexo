import{j as e}from"./jsx-runtime-BjG_zV1W.js";import{r as k}from"./chunk-KNED5TY2-DvhD41lM.js";import{C as y,a as C}from"./card-3ARTUL8o.js";import{I as f}from"./input-CYFwwULt.js";import{c as _}from"./utils-DjqsqOe8.js";import{B as S}from"./button-D9Y7BBUR.js";import{S as x,a as p,b as j,c as h,C as o,d as b}from"./types-CHFWEMIi.js";function E({className:l,...t}){return e.jsx("textarea",{"data-slot":"textarea",className:_("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",l),...t})}function v({label:l,values:t=[],onChange:a}){const[d,u]=k.useState(""),g=()=>{d.trim()&&(a([...t,d.trim()]),u(""))},N=n=>{const c=[...t];c.splice(n,1),a(c)};return e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:l}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:t.map((n,c)=>e.jsxs("div",{className:"flex items-center bg-muted text-muted-foreground px-2 py-1 rounded text-sm",children:[n,e.jsx("button",{onClick:()=>N(c),className:"ml-2 text-red-500 hover:text-red-700",type:"button",children:"×"})]},c))}),e.jsx(f,{placeholder:"Type and press Enter",value:d,onChange:n=>u(n.target.value),onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),g())}})]})}function G({situation:l,themes:t,onChange:a,onSave:d,loading:u=!1,title:g}){var c;if(u)return e.jsx("p",{className:"p-4",children:"Loading..."});if(!l)return e.jsx("p",{className:"p-4",children:"Situation not found."});const N=(s,r)=>{const m=(l==null?void 0:l[s])??[],w=m.includes(r)?m.filter(i=>i!==r):[...m,r];a(s,w)},n=(s,r,m)=>{const w=(l==null?void 0:l[r])??[];return e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:s}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(i=>e.jsx(S,{variant:w.includes(i)?"default":"outline",onClick:()=>N(r,i),children:i},i))})]})};return e.jsx(y,{className:"m-4 max-w-3xl mx-auto",children:e.jsxs(C,{className:"space-y-4 py-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:g}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Title"}),e.jsx(f,{value:l.title??"",onChange:s=>a("title",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Goal"}),e.jsx(f,{value:l.goal??"",onChange:s=>a("goal",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Description"}),e.jsx(E,{value:l.description??"",onChange:s=>a("description",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Duration (minutes)"}),e.jsx(f,{type:"number",value:((c=l.duration)==null?void 0:c.toString())??"",onChange:s=>a("duration",Number(s.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Level"}),e.jsxs(x,{value:l.level??"",onValueChange:s=>a("level",s),children:[e.jsx(p,{className:"w-full",children:e.jsx(j,{placeholder:"Select level"})}),e.jsx(h,{children:o.public.Enums.level.map(s=>e.jsx(b,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Theme"}),e.jsxs(x,{value:l.theme?String(l.theme):"",onValueChange:s=>a("theme",Number(s)),children:[e.jsx(p,{className:"w-full",children:e.jsx(j,{placeholder:"Select theme"})}),e.jsx(h,{children:t.map(s=>e.jsx(b,{value:String(s.id),children:s.name??`Theme ${s.id}`},s.id))})]})]}),["sea_min","sea_max"].map(s=>e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:s.replace("_"," ").toUpperCase()}),e.jsxs(x,{value:l[s]??"",onValueChange:r=>a(s,r),children:[e.jsx(p,{className:"w-full",children:e.jsx(j,{placeholder:`Select ${s}`})}),e.jsx(h,{children:o.public.Enums.sea.map(r=>e.jsx(b,{value:r,children:r},r))})]})]},s)),["wind_min","wind_max"].map(s=>e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:s.replace("_"," ").toUpperCase()}),e.jsxs(x,{value:l[s]??"",onValueChange:r=>a(s,r),children:[e.jsx(p,{className:"w-full",children:e.jsx(j,{placeholder:`Select ${s}`})}),e.jsx(h,{children:o.public.Enums.wind.map(r=>e.jsx(b,{value:r,children:r},r))})]})]},s)),n("Crafts","crafts",[...o.public.Enums.craft]),n("Crews","crews",[...o.public.Enums.crew]),e.jsx(v,{label:"Cues",values:l.cues??[],onChange:s=>a("cues",s)}),e.jsx(v,{label:"Instructions – Setup",values:l.instructions_setup??[],onChange:s=>a("instructions_setup",s)}),e.jsx(v,{label:"Instructions – Security",values:l.instructions_security??[],onChange:s=>a("instructions_security",s)}),e.jsx(v,{label:"Instructions – Do",values:l.instructions_do??[],onChange:s=>a("instructions_do",s)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(S,{variant:"secondary",onClick:()=>history.back(),children:"Cancel"}),e.jsx(S,{onClick:d,children:"Save"})]})]})})}export{G as S};
